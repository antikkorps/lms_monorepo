# =============================================================================
# LMS Platform - Environment Variables
# =============================================================================
# Copy this file to .env and fill in the values

# -----------------------------------------------------------------------------
# Database - PostgreSQL
# -----------------------------------------------------------------------------
POSTGRES_USER=lms
POSTGRES_PASSWORD=change_me_in_production
POSTGRES_DB=lms
POSTGRES_PORT=5433

# Full connection URL (used by API - note: port 5433 to avoid conflict with local postgres)
DATABASE_URL=postgres://lms:change_me_in_production@localhost:5433/lms

# -----------------------------------------------------------------------------
# Cache - Redis
# -----------------------------------------------------------------------------
REDIS_PORT=6379
REDIS_URL=redis://localhost:6379

# -----------------------------------------------------------------------------
# API Configuration
# -----------------------------------------------------------------------------
NODE_ENV=development
API_PORT=3000

# JWT Secret - MUST be changed in production (use: openssl rand -base64 32)
JWT_SECRET=dev-jwt-secret-change-in-production
JWT_EXPIRES_IN=7d

# CORS Origins (comma-separated)
CORS_ORIGINS=http://localhost:5173,http://localhost:4321

# Rate Limiting (per tier, requests per window)
# B2C: Standard users
RATE_LIMIT_B2C_WINDOW_MS=60000
RATE_LIMIT_B2C_MAX=100
# B2B: Tenant users
RATE_LIMIT_B2B_WINDOW_MS=60000
RATE_LIMIT_B2B_MAX=500
# B2B Premium: High-tier tenants (DEDICATED isolation)
RATE_LIMIT_B2B_PREMIUM_WINDOW_MS=60000
RATE_LIMIT_B2B_PREMIUM_MAX=1000
# Auth endpoints: Stricter limits to prevent brute force
RATE_LIMIT_AUTH_WINDOW_MS=60000
RATE_LIMIT_AUTH_MAX=10

# -----------------------------------------------------------------------------
# Frontend Configuration
# -----------------------------------------------------------------------------
APP_PORT=5173
VITE_API_URL=http://localhost:3000

# -----------------------------------------------------------------------------
# Landing Page Configuration
# -----------------------------------------------------------------------------
LANDING_PORT=4321

# -----------------------------------------------------------------------------
# Stripe (Payment)
# -----------------------------------------------------------------------------
STRIPE_SECRET_KEY=sk_test_your_key_here
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret_here
STRIPE_PUBLISHABLE_KEY=pk_test_your_key_here

# -----------------------------------------------------------------------------
# Email (Postmark/SendGrid)
# -----------------------------------------------------------------------------
# Provider: 'console' (dev, logs only), 'postmark', or 'sendgrid'
EMAIL_PROVIDER=console
EMAIL_FROM=noreply@yourdomain.com
EMAIL_FROM_NAME=LMS Platform
# Postmark (if EMAIL_PROVIDER=postmark)
POSTMARK_API_KEY=your_postmark_key_here
# SendGrid (if EMAIL_PROVIDER=sendgrid)
SENDGRID_API_KEY=your_sendgrid_key_here

# -----------------------------------------------------------------------------
# SSO (OAuth2/OpenID Connect)
# -----------------------------------------------------------------------------
# Callback URL for OAuth providers (must match your OAuth app config)
SSO_CALLBACK_URL=http://localhost:3000/api/v1/auth/sso/callback

# Google OAuth (https://console.cloud.google.com/apis/credentials)
GOOGLE_CLIENT_ID=your_google_client_id
GOOGLE_CLIENT_SECRET=your_google_client_secret

# Microsoft Entra ID / Azure AD (https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/RegisteredApps)
MICROSOFT_CLIENT_ID=your_microsoft_client_id
MICROSOFT_CLIENT_SECRET=your_microsoft_client_secret
# Tenant ID: 'common' (any account), 'organizations' (work/school only), or specific tenant UUID
MICROSOFT_TENANT_ID=common

# -----------------------------------------------------------------------------
# Cloudflare (shared for R2 Storage + Stream)
# -----------------------------------------------------------------------------
CLOUDFLARE_ACCOUNT_ID=your_account_id
CLOUDFLARE_API_TOKEN=your_api_token

# -----------------------------------------------------------------------------
# Storage (Cloudflare R2)
# -----------------------------------------------------------------------------
# Provider: 'local' (dev, saves to uploads/), 'r2' (Cloudflare R2)
STORAGE_PROVIDER=local
# Local storage path (when STORAGE_PROVIDER=local)
STORAGE_LOCAL_PATH=./uploads
# R2 credentials (when STORAGE_PROVIDER=r2) - create via R2 > Manage API tokens
R2_ACCESS_KEY_ID=your_r2_access_key
R2_SECRET_ACCESS_KEY=your_r2_secret_key
R2_BUCKET_NAME=lms-assets
# URL publique pour accéder aux fichiers Custom domain : https://assets.votredomaine.com (recommandé)
R2_PUBLIC_URL=https://assets.yourdomain.com

# -----------------------------------------------------------------------------
# Monitoring
# -----------------------------------------------------------------------------
SENTRY_DSN=https://your_sentry_dsn_here

# -----------------------------------------------------------------------------
# Production Only
# -----------------------------------------------------------------------------
# DOMAIN=lms.yourdomain.com
# TLS_EMAIL=admin@yourdomain.com
